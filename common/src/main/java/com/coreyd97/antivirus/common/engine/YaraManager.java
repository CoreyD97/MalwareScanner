package com.coreyd97.antivirus.common.engine;

import com.coreyd97.antivirus.common.utils.ScannerEngineUtils;
import com.github.plusvic.yara.Yara;
import com.github.plusvic.yara.YaraCompiler;
import com.github.plusvic.yara.YaraFactory;
import com.github.plusvic.yara.YaraScanner;

import java.io.File;

public class YaraManager {
    private Yara yara;
    private YaraCompiler compiler;

    public YaraManager(File[] ruleFiles){
        this.yara = YaraFactory.create(YaraFactory.Mode.EMBEDDED);
        this.compiler = yara.createCompiler();

        ScannerEngineUtils.RuleImportTask importTask = new ScannerEngineUtils.RuleImportTask(ruleFiles, null, yara, compiler);
        importTask.run();
    }

    public YaraScanner getScanner(){
        return compiler.createScanner();
    }
}

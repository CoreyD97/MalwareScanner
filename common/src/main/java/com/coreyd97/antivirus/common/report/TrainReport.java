package com.coreyd97.antivirus.common.report;

import com.coreyd97.antivirus.common.engine.DetectionModule;
import com.coreyd97.antivirus.common.taskscheduler.TrainTask;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;
import java.util.UUID;

//Store statistics and information regarding the training of a heuristic engine.
public class TrainReport extends Report {
    public final UUID taskUUID;
    public final String detectionModule;
    public int trainedSamples, failedSamples, existingSamples;
    Map<String, Integer> causeOfFailure;

    public TrainReport(DetectionModule detectionModule, TrainTask trainTask){
        this.detectionModule = detectionModule.getModuleName();
        this.taskUUID = trainTask.getUUID();
        this.causeOfFailure = new HashMap<>();
    }

    public void addFailedSample(String cause){
        if(causeOfFailure.containsKey(cause)){
            causeOfFailure.put(cause, causeOfFailure.get(cause)+1);
        }else{
            causeOfFailure.put(cause, 1);
        }
    }

    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("Total Trained Samples: " + trainedSamples + "\n");
        sb.append("Failed Samples: " + failedSamples + "\n");
        sb.append("Causes of Failure: \n");
        causeOfFailure.forEach((cause, count) -> {
            sb.append(cause + "-" + count + "\n");
        });
        return sb.toString();
    }
}

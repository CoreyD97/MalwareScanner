package com.coreyd97.antivirus.common.report;

import com.coreyd97.antivirus.common.engine.DetectionModule;
import com.coreyd97.antivirus.common.taskscheduler.ScanTask;

import java.io.File;
import java.net.Inet4Address;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.UUID;

/**
 * Contains the file paths and their relevant features for analysis
 */
public class ScanReport extends Report {
    private final UUID taskUUID;
    private final String detectionModule;
    private final ArrayList<FileFeatures> fileFeatures;
    private final ScanTask.ScanType type;

    public ScanReport(DetectionModule detectionModule, ScanTask scanTask, ScanTask.ScanType type){
        this.detectionModule = detectionModule.getModuleName();
        this.taskUUID = scanTask.getUUID();
        fileFeatures = new ArrayList<>();
        this.type = type;
    }

    public void addFileFeatures(FileFeatures fileFeatures){
        synchronized (this.fileFeatures) {
            this.fileFeatures.add(fileFeatures);
        }
    }

    public UUID getTaskUUID() {
        return taskUUID;
    }

    public String getDetectionModule() {
        return detectionModule;
    }

    public ArrayList<FileFeatures> getFileFeatures() {
        return fileFeatures;
    }

    public ScanTask.ScanType getType() {
        return type;
    }
}

package com.coreyd97.antivirus.common.report;

import com.coreyd97.antivirus.common.taskscheduler.ScanTask;

import java.util.ArrayList;
import java.util.UUID;

public class ResultsReport extends Report {
    private UUID taskUUID;
    final ArrayList<MalwareEntry> foundMalware;

    private ResultsReport(){
        this.foundMalware = new ArrayList<>();
    }

    public ResultsReport(ScanReport scanReport){
        this();
        this.setUUID(scanReport.getUUID());
        this.taskUUID = scanReport.getTaskUUID();
    }

    public ResultsReport(ScanTask scanTask){
        this();
        this.taskUUID = scanTask.getUUID();
    }

    public void addMalware(MalwareEntry malwareEntry){
        synchronized (this.foundMalware){
            this.foundMalware.add(malwareEntry);
        }
    }

    public UUID getTaskUUID() {
        return taskUUID;
    }

    public ArrayList<MalwareEntry> getFoundMalware() {
        return foundMalware;
    }

    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("---------------------------------------------------\n");
        sb.append("---------------------------------------------------\n");
        sb.append("--------------Malware Report--------------\n");
        sb.append("---------------------------------------------------\n");
        sb.append("---------------------------------------------------\n\n");
        for (MalwareEntry malwareEntry : this.foundMalware) {
            sb.append(malwareEntry.toString() + "\n\n");
        }
        return sb.toString();
    }
}

import com.coreyd97.antivirus.common.report.ScanReport;
import com.github.katjahahn.parser.PEData;
import com.github.katjahahn.parser.PELoader;
import com.github.katjahahn.parser.sections.SectionLoader;
import com.github.katjahahn.parser.sections.idata.ImportDLL;
import com.github.katjahahn.parser.sections.idata.ImportSection;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

public class TestPELoader {
    public static void main(String[] args) {
        File file = new File("SampleFolder/Ace32Loader.exe");
        try {
            PEData data = PELoader.loadPE(file);
            SectionLoader sectionLoader = new SectionLoader(data);
            ImportSection section = sectionLoader.loadImportSection();
            List<ImportDLL> imports = section.getImports();
            for (ImportDLL anImport : imports) {
                System.out.println(anImport.getName());
            }

        } catch (IOException | IllegalStateException e) {
            e.printStackTrace();
//                String cause;
//                if (e instanceof FileFormatException) {
//                    cause = "Invalid PE32 File. ";
//                } else if (e instanceof IllegalStateException) {
//                    cause = "Could not find import section. ";
//                } else {
//                    cause = "Could not open file. ";
//                }
//                ((TrainReport) this.scanReport).addFailedSample(cause, file.getAbsolutePath());
        }
    }
}

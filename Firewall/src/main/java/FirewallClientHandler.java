import com.coreyd97.antivirus.common.engine.CryptoManager;
import com.coreyd97.antivirus.common.network.ClientConnection;
import com.coreyd97.antivirus.common.network.ServerThread;

import java.io.IOException;
import java.net.Inet4Address;
import java.net.Socket;

public class FirewallClientHandler extends ServerThread {

    private final ClientManager clientManager;

    public FirewallClientHandler(ClientManager clientManager, CryptoManager cryptoManager,
                                 short port) throws IOException {
        this(clientManager, cryptoManager, (Inet4Address) Inet4Address.getByName("0.0.0.0"), port);
    }

    public FirewallClientHandler(ClientManager clientManager, CryptoManager cryptoManager,
                                 Inet4Address listenAddress, short port) throws IOException {
        super(cryptoManager, listenAddress, port);
        this.clientManager = clientManager;
    }

    @Override
    public ClientConnection buildClient(Socket clientSocket) throws IOException {
        return new FirewallClientConnection(this, clientSocket);
    }

    public ClientManager getClientManager() {
        return clientManager;
    }
}

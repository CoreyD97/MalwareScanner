package com.coreyd97.antivirus.server.taskscheduler;

import com.coreyd97.antivirus.common.taskscheduler.Task;
import com.coreyd97.antivirus.common.taskscheduler.TaskListener;

import java.util.ArrayList;

public class TaskScheduler implements TaskListener {
    ArrayList<Task> tasks;
    ArrayList<TaskSchedulerListener> schedulerListeners;

    public TaskScheduler(){
        this.tasks = new ArrayList<>();
        this.schedulerListeners = new ArrayList<>();
    }

    public void registerTask(Task task){
        this.tasks.add(task);
        task.registerTaskListener(this);

        for (TaskSchedulerListener schedulerListener : schedulerListeners) {
            schedulerListener.onTaskAdded(task);
        }
    }

    public void removeTask(Task task){
        this.tasks.remove(task);
        for (TaskSchedulerListener schedulerListener : this.schedulerListeners) {
            schedulerListener.onTaskRemoved(task);
        }
    }


    public void registerSchedulerListener(TaskSchedulerListener listener){
        this.schedulerListeners.add(listener);
    }

    public void removeSchedulerListener(TaskSchedulerListener listener){
        this.schedulerListeners.remove(listener);
    }

    @Override
    public void onTaskProgress(Task task) {

    }

    @Override
    public void onTaskStart(Task task, int steps) {

    }

    @Override
    public void onTaskStepsAdded(Task task, int steps) {

    }

    @Override
    public void onTaskComplete(Task task) {
        removeTask(task);
    }
}

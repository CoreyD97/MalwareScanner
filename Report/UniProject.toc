\boolfalse {citerequest}\boolfalse {citetracker}\boolfalse {pagetracker}\boolfalse {backtracker}\relax 
\defcounter {refsection}{0}\relax 
\contentsline {chapter}{\numberline {1}Introduction}{3}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {1.1}Malware Detection Techniques: an Overview}{4}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {1.1.1}Hash Based}{4}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {1.1.2}Byte Signature Based}{4}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {1.1.3}Heuristics Based}{4}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {1.1.4}Behavioural Analysis Based}{5}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {1.2}Existing Solutions}{5}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {1.2.1}Carbon Black}{5}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {1.2.2}Sophos}{5}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {1.2.3}Windows Defender}{6}
\defcounter {refsection}{0}\relax 
\contentsline {chapter}{\numberline {2}NetProtect Requirements}{7}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {2.1}Requirement 1: Malware Classification}{7}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {2.2}Requirement 2: Extensibility}{7}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {2.3}Requirement 3: Network Quarantine}{7}
\defcounter {refsection}{0}\relax 
\contentsline {chapter}{\numberline {3}NetProtect Design}{9}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {3.1}Architecture Overview}{9}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {3.1.1}Scanning Procedure}{10}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Scan Process}{10}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Report Submission}{11}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Analysis}{11}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {3.2}Architecture in Detail}{11}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {3.2.1}Client Architecture}{11}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Interface}{12}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Scan Modules}{14}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Hash Based Scan Module}{14}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Byte Signature Based Scan Module}{14}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Import Heuristic Based Scan Module}{15}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Combined Technique Scan Module}{15}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {3.2.2}Server Architecture}{15}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Interface}{16}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{C4.5 Algorithm}{17}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Hash Based Analysis Module}{18}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Byte Signature Based Analysis Module}{18}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Import Heuristic Based Analysis Module}{18}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Combined Technique Analysis Module}{18}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {3.2.3}Firewall Architecture}{18}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Quarantine Component}{19}
\defcounter {refsection}{0}\relax 
\contentsline {chapter}{\numberline {4}NetProtect Implementation}{21}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {4.1}Design Patterns}{21}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {4.1.1}Template Method Pattern}{21}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Scan Task}{22}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Analysis Task}{22}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Network Task}{23}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {4.1.2}Observer Pattern}{23}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {4.2}Training Data Acquisition}{24}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {4.3}Libraries Utilised by NetProtect}{24}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {4.3.1}YARA - Pattern Matching Utility}{24}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {4.3.2}PortEx - Portable Executable Analysis }{26}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {4.4}Network Quarantine Implementation}{26}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {4.5}Optimisations to the C4.5 Algorithm}{28}
\defcounter {refsection}{0}\relax 
\contentsline {chapter}{\numberline {5}Evaluation}{30}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {5.1}Accuracy}{30}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {5.1.1}Import Heuristic Based}{30}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {5.1.2}Byte Signature Based}{32}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {5.1.3}Combined Technique}{34}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {5.1.4}Conclusions}{35}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {5.2}Speed}{36}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {5.3}Quarantine Speed}{36}
\defcounter {refsection}{0}\relax 
\contentsline {chapter}{\numberline {6}Conclusion}{38}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {6.1}Future Improvements}{38}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {6.1.1}NetProtect Client}{38}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Byte Signature Based Analysis}{38}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {6.1.2}Scan Report Submission}{39}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {6.1.3}NetProtect Analysis Server}{39}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Combined Technique Analysis Module}{39}
\defcounter {refsection}{0}\relax 
\contentsline {subsubsection}{Client Management}{39}
\defcounter {refsection}{0}\relax 
\contentsline {subsection}{\numberline {6.1.4}NetProtect Firewall Server}{40}
\defcounter {refsection}{0}\relax 
\contentsline {chapter}{Appendices}{41}
\defcounter {refsection}{0}\relax 
\contentsline {chapter}{\numberline {A}Appendix A}{41}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {A.1}Malicious Sample Counts}{41}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {A.2}Non-Malicious Sample Counts}{42}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {A.3}Testing Data File Size}{42}
\defcounter {refsection}{0}\relax 
\contentsline {chapter}{\numberline {B}Appendix B}{43}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {B.1}C4.5 Tree - Yara Rules}{43}
\defcounter {refsection}{0}\relax 
\contentsline {section}{\numberline {B.2}C4.5 Tree - Function Import Heuristics}{44}
